<!-- 
<script>
$.getScript("/vendor/jobdetailscript.js");

</script>

 <div id="powerwidgets">
    <div class="row" style="margin-left:0px;margin-right:0px">
      <div class="col-md-12  bootstrap-grid">
        <div class="powerwidget blue" data-widget-editbutton="false" data-widget-deletebutton="false">
          <header>
            <h2>PART A</h2>
          </header>
          <div class="inner-spacer">
            <div class="row">
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job ID: <%=@job.id%> </div>
            </div>
              <div class="row"> 
              
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job Posting Status: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:100px">
                 <a href="javascript:void(0)" class="editable-click" id ="job_status" data-name="job_status" data-type="select" data-pk="<%=@job.id%>" data-url="/updatejobstatus" data-source="[  {value: 1, text: 'Pending'}, {value: 2, text: 'Active'} ]"   data-title="Select Job Posting Status">  </a>
                    
              </div>
             </div> 
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Change to Pending if you want this job to be reviewed by the hiring manager </div>
              <div style="position: relative;top:-15px; left: 10px; font-size=0.7em;font-style: italic; color:grey" >Change to Active if you want to start matching candidates to this job now </div>
             </div>    
           </div>
        </div>

        <div class="powerwidget blue" data-widget-editbutton="false" data-widget-deletebutton="false">
          <header>
            <h2>PART B</h2>
          </header>
          <div class="inner-spacer">
            <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Contact Person: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:400px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_contactname" data-name="job_contactname" data-type="text" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Enter Contact Person">  </a>
              </div>
            </div>
            <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Enter the contact person for this job opening </div>
              
             </div>  
            <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Contact Email: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:400px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_contactemail" data-name="job_contactemail" data-type="text" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Enter Contact Email"> </a>
              </div>
            </div>
            <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Enter the email address of this contact person </div>
             </div>  
            <div class="row">  
                <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Phone #: </div>
                <div class="inputtext col-md-2 column" style="position:absolute;left:150px"> 
                 <a class="editable-click" href="javascript:void(0)"  id="job_contactphone" data-name="job_contactphone" data-type="text" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Enter Contact Number"> </a>
                </div>
            </div> 
            <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Enter the contact number of this contact person </div>
             </div>  
            <div class="row" style="position:relative">
            <div class="inputlabel col-md-4 col-lg-4 col-sm-6 col-xs-12 column" style="left:10px">I want to reveal our company detail to candidate</div> 
              <label>
                <div style="position:absolute; left:320px;top:0px" style="col-md-1 col-lg-1" ><input  onclick="revealcheck(this,<%=@job.id%>)" id="revealcheck" name="job_companyreveal" type="checkbox"  checked />  </div>
                <span class="lbl"> </span>
              </label>
	         </div> <!-- row -->  
           <div class="row" style="">
              <div style="position: relative;top:-25px; left:10px; font-size=0.7em;font-style: italic; color:grey" > checking this box means that you want candidates to see your company profile that you have updated in <a TARGET="_blank" href="/companyprofile">Company Profile</a> </div>
             </div>  

			<div class="row">
              <div class="inputlabel col-md-4 col-lg-3 col-xs-12 col-sm-5 column">  </div> 
              
                <span style="position:relative; left:-260px; top:20px" id="CVsection"> 
                  
                  <a id="displaycv" style="visibility: visible;" href=<%= @job.job_jdurl %> target="_blank"> <i style="font-size: 25px;" class="fa fa-file-text-o"><br><div style="font-size: 14px;left:-10px;position:relative">JD</div></i> </a>
                </span>
              
              <script src='/vendor/jqueryfileupload/js/vendor/jquery.ui.widget.js' type='text/javascript'></script>
              <script src='/vendor/jqueryfileupload/js/jquery.iframe-transport.js' type='text/javascript'></script>
              <script src='/vendor/jqueryfileupload/js/jquery.fileupload.js' type='text/javascript'></script>
              <script src='/vendor/jqueryfileupload/js/jquery.fileupload-process.js' type='text/javascript'></script>
              <script src='/vendor/jqueryfileupload/js/jquery.fileupload-validate.js' type='text/javascript'></script>
              <script src='/vendor/cloudinary/jquery.cloudinary.js' type='text/javascript'></script>
              <script type="text/javascript">$.cloudinary.config({cloud_name:'dashy', api_key:'219441847515364'}); </script>
              
              <span style="position:relative; left:-220px; top:5px" class="btn dark-blue-btn btn-primary fileinput-button">
                <div id="uploadprogress">
                  <i class="glyphicon glyphicon-plus"></i> <span >Update JD file</span>
                </div> 
                
                <input name="file" type="file" id="fileupload" class="cloudinary-fileupload" data-cloudinary-field="image_upload" >
              </span>
              <!-- <div  id="uploadprogress" style="position:relative; top:-25px; left: -25px;">AA </div> -->
            </div> <!--upload row-->
            <div class="row" style="">
              <div style="position: relative;top:10px; left:10px; font-size=0.7em;font-style: italic; color:grey" > Candidates that matches the requirement will be presented with this original JD softcopy. </div>
             </div>  
            <br><br> 
                <script type="text/javascript">
                $(function(){
                  $('#fileupload').fileupload({
                      add: function (e, data) {
                          $.getJSON('/filer_jd', {pk: <%=@job.id %> }, function (result) {  
                              data.formData = result; // e.g. {id: 123}
                              data.submit();
                          }).fail( function(d, textStatus, error) {
                              console.error("Error! Please contact helpdesk. Status: " + textStatus + ", error: "+error)
                          });
                      },
                      url: "https://api.cloudinary.com/v1_1/dashy/upload",
                      acceptFileTypes: /(\.|\/)(doc?x|pdf|txt)$/i, 
                      // The maximum allowed file size in bytes:
                      maxFileSize: 10000000, // 10 MB
                      // The minimum allowed file size in bytes:
                      minFileSize: 1, // No minimal file size
                      // The limit of files to be uploaded:
                      maxNumberOfFiles: 10
                    })
                  // .on('fileuploadfail', function (e, data) {
                  //     var currentFile = data.files[data.index];
                  //     alert("Error! Please contact helpdesk");
                  //     if (data.files.error && currentFile.error) {
                  //       // there was an error, do something about it
                  //       // newAlert("#alert_placeholder-tab",'danger', currentFile.error);
                     
                  //     }
                  //   });
                  });

                  $('.cloudinary-fileupload').bind('cloudinarydone', function(e, data) { 
                     $.ajax({
                          url: '/jduploaded',
                          type: 'POST',
                          data: {"jdurl": data.result.url, "pk" : <%=@job.id %>},
                          success: function(response){
                            tt = "<a id='displaycv' style='visibility: visible'; href=".concat(data.result.url,"><i style='font-size: 25px;' class='fa fa-file-text-o'><br><div style='font-size: 14px;left:-10px;position:relative'>JD</div></i></a>");
                            $('#CVsection').html(tt);
                                            
                            $("#uploadprog").html("Uploading is complete!");
                            $('#uploadprog').fadeOut(3000, function() {
                              $(this).remove();
                              $("#uploadprogress").html("<i class='glyphicon glyphicon-plus'></i> <span >Upload new CV</span>");
                             });
                            //newAlert("#alert_placeholder-tab", 'success', "File uploaded successfully!");



                          }
                     }); //ajax
                     return true;
                  }); //cloudinary done

                  $('.cloudinary-fileupload').bind('fileuploadprogress', function(e, data) {
                    $("#uploadprogress").html("<div id='uploadprog'> <i class='fa fa-spinner fa-spin'></i>Uploading in progress</div> </div>");
                  });

                  $('.cloudinary-fileupload').bind('fileuploadstop', function(e, data) {

                  });

                   $('.cloudinary-fileupload').bind('fileuploadfail', function(e, data) {
                      alert(data.files[0].error);
                  });
              </script>


          </div>
        </div>
        <div class="powerwidget blue" data-widget-editbutton="false" data-widget-deletebutton="false">
          <header>
            <h2>PART C</h2>
          </header>
          <div class="inner-spacer">

	         <div class="row"> 
            
            <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Closing Date:</label></div> <!-- # default to 6 months. -->
            <div class="col-md-2 col-lg-2 column" style="position:absolute; left:135px"> 
                <input readonly="true" type="text" style=" width: 260px;height: 35px;" name="date-range-picker" id="id-date-range-picker-1"  class="inputtext form-control rdonly"  class="span4"></input> <div id="saving_date"></div> <!--set a date 6 months from today as default-->
            </div>
                           
           </div>
           <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Closing date for this position to find a matching candidate. On T+1, this job posting will have the status = closed </div>
             </div>  

	         <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job Title: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:150px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_title" data-name="job_title" data-type="select"  data-title="Enter Job Title" >   </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >What is the Job Title for this position? </div>
             </div>  
             <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job Function: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:200px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_function" data-name="job_function" data-type="select"  data-title="Enter Job Function" >  </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Job function describes what this role is about. Please indicate the related years of experience below</div>
             </div>  
             <div class="row" style="position:relative"> 
              <div style="left:10px;" class="inputlabel col-md-2 col-lg-2  col-sm-3 col-xs-12 column">Related Experience: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:155px;width:50px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_experience" data-name="job_experience" data-type="text"  data-title="Enter years of related experience"><%= @job.job_experience %> </a>
              </div>
              <div style="position:absolute; left:200px; top:5px" class="col-md-2 col-sm-2 column">  <span>years</span></div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >How many years of related experience must the candidate have for the above stated Job Function? </div>
             </div>  
             <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job Location: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:150px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_location" data-name="job_location" data-type="select"  data-title="Enter Job Location" >   </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Where is the location of this job position? </div>
             </div>  
             <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Job Industry: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:250px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_industry" data-name="job_industry" data-type="select" data-title="Enter Job Industry" >  </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >What industry is the company operating in?</div>
             </div>  
             <div class="row"> 
              <div class="inputlabel col-md-3 col-lg-2  col-sm-3 col-xs-12 column" style="left:10px">Travel Requirement: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:50px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_travel" data-name="job_travel" data-source="[{value: 0, text: '0%'}, {value: 25, text: '25%'}, {value: 50, text: '50%'}, {value: 75, text: '75%'}, {value: 100, text: '100%'}]" data-type="select" data-title="Enter Travel Requirement">  </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" > How much travelling is required for this job? </div>
             </div>  
            <div class="row" style="position:relative">
            <div class="inputlabel col-md-3 col-lg-2  col-sm-4 col-xs-12 column" style="left:10px">No preference on Nationality?</div> <!-- this will hide the dropdown list-->
              <label>
                <div style="position:absolute; left:200px;top:0px" style="col-md-1 col-lg-1" ><input  onclick="nationalityallcheck(this,<%=@job.id%>)" id="nationalityallcheck" name="job_nationalityall" type="checkbox"  unchecked %> />  </div>
                <span class="lbl"> </span>
              </label>
           </div> <!-- row -->  
             <div id="displaynationality"  style="visibility: visible;">
             <div class="row"> 
              <div id="t1" class="inputlabel col-md-3 col-lg-2  col-sm-4 col-xs-12 column" style="left:10px;">Preferred Nationality : </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:150px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_nationality" data-name="job_nationality" data-type="select" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Select Nationality Requirement"  > <%=@nationalitymaster%></a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" > Candidate is preferred to be from this country </div>
             </div>  
             
             <div class="row" style="position:relative">
              <div id="t2" class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">PR may also apply</div> 

              <label>
                <div style="position:absolute; left:155px;top:0px" style="col-md-1 col-lg-1" ><input  onclick="nationalityprcheck(this,<%=@job.id%>)" id="nationalityprcheck" name="job_nationalitypr" type="checkbox"  <%= @job.job_nationalitypr== true ? "checked" : "unchecked" %> />  </div>
                <span class="lbl"> </span>
              </label>
             </div> <!-- row -->    
             <div class="row" style="">
              <div style="position: relative;top:-25px; left:10px; font-size=0.7em;font-style: italic; color:grey" >PR from the above selected country can also apply for this job</div>
             </div>  
              </div> <!-- #displaynationality -->
              <div class="infobox col-md-2 col-lg-2  col-sm-2 column" id="infobox" style="position:absolute;right:200px;top:200px"> This is the explationation box </div>
              <div class="row" style="position:relative"> 
                <div style="left:10px;" class="inputlabel col-md-2 col-lg-2  col-sm-3 col-xs-12 column">Minimum Salary: S$ </div>
                <div class="inputtext col-md-2 column" style="position:absolute;left:155px;width:100px">
                   <a class="editable-click editable" href="javascript:void(0)" id="job_salarymin" data-name="job_salarymin" data-type="text" data-pk="1" data-url="/updatejob" data-title="Enter Minimum Salary SGD$:"><%= @job.job_salarymin.to_s %>   </a>
                </div> 
                <div style="position:absolute; left:250px; top:5px" class="col-md-2 col-sm-2 column">  <span>per month </span></div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Minimum monthly salary for this position </div>
             </div>  
             <div class="row" style="position:relative"> 
              <div style="left:10px;" class="inputlabel col-md-2 col-lg-2  col-sm-3 col-xs-12 column">Maximum Salary: S$</div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:155px;width:100px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_salarymax" data-name="job_salarymax" data-type="text" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Enter Maximum Salary SGD$:"><%= @job.job_salarymax.to_s %>   </a> 
              </div> 
              <div style="position:absolute; left:250px; top:5px" class="col-md-2 col-sm-2 column">  <span>per month </span></div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Maximum monthly salary for this position </div>
             </div>  
             
             <div class="row"> 
              <div class="inputlabel col-md-2 col-lg-2  col-sm-2 col-xs-12 column" style="left:10px">Employment Type: </div>
              <div class="inputtext col-md-2 column" style="position:absolute;left:150px;width:100px">
                 <a class="editable-click" href="javascript:void(0)"  id="job_time" data-name="job_time" data-type="select" data-pk="<%=@job.id %>" data-url="/updatejob" data-title="Enter Job type" data-value=<%= @job.job_time %>  > </a>
              </div>
             </div>
             <div class="row" style="">
              <div style="position: relative;top:-15px; left:10px; font-size=0.7em;font-style: italic; color:grey" >What is the employment type? </div>
             </div>  
             
             <div class="row" style="position:relative">
              <div class="inputlabel col-md-4 col-lg-4  col-sm-3 col-xs-12 column" style="left:10px">Must be willing to work after office hour</div> <!-- show this only if nationalityall or non Singapore is selected-->
              <label>
                <div style="position:absolute; left:270px;top:0px" style="col-md-1 col-lg-1" ><input  onclick="workemergencycheck(this,<%=@job.id%>)" id="workemergencycheck" name="job_workemergency" type="checkbox"  <%= @job.job_workemergency== true ? "checked" : "unchecked" %> />  </div>
                <span class="lbl"> </span>
              </label>
            
             </div> <!-- row -->    
             <div class="row" style="">
              <div style="position: relative;top:-25px; left:10px; font-size=0.7em;font-style: italic; color:grey" >Some jobs require the employee to work after office hour. For example, system admins are required to perform maintenance after office hour or weekends</div>
             </div>
          </div> <!-- innerspacer -->
          </div> <!--powerwidget -->


<!-- TSCHEW -->

    <div class="row">
      <div class="col-md-12 bootstrap-grid">
        <div class="powerwidget blue" id="most-form-elements" data-widget-editbutton="false" data-widget-deletebutton="false">
          <header>
            <h2>PART D</h2>
          </header>
          <div class="callout callout-info">
          <h4>Requirements Gathering</h4>
          <p>Skills: Add all relevant skills and their expected level of expertise. Jorb.co matches only candidates with the best fit </p>
          <p>Languages: What's the spoken and written languages and their expertise level</p>
          <p>Education: What are the various educations that the candidates must go through. You can indicate if you have very strong preference (mandatory) for a particular education, or simply nice to have.</p>
          <p>Certificates: What are the professional certificates that the candidates must possess for this role</p>
          <p> If you can't find any of your skills/languages/education/certificates from the respective drop-down menu, please request to have them added by writing to request@jorb.co</p>
          </div>
          <div class="loading"> </div>
          <div class="inner-spacer"> 
            <ul class="nav nav-tabs"> 
              <li class="active"><a data-toggle="tab" href="#skilltab"> Skills Requirement</a></li>   
              <li><a id="languagetabclick" data-toggle="tab" href="#languagetab"> Languages Requirement</a></li>         
              <li><a id="edutabclick" data-toggle="tab" href="#edutab"> Education Requirement</a></li>   
              <li><a id="certtabclick" data-toggle="tab" href="#certtab"> Certificate Requirement</a></li>               
            </ul>
            <div class="tab-content">


          <div id="skilltab" class="tab-pane active">
            <div class="row"> 
              <div class="col-sm-12 col-lg-12 ">
                <div id="skilltable">
                  <div style="text-align:center">
                  <a href="#addskillmodal" data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                      <span class="btn dark-blue-btn btn-primary">Add New Skill Requirement</span>
                  </a>
                  <br><br>
                </div>
                  <div id="st"> <!-- Skill management table will be loaded in this div --></div>
                  <br><br>
                </div> <!-- skilltable" -->
              </div> <!-- <div class="col-sm-12 col-lg-12 "> -->               
            </div>    <!-- row --> 
          </div> <!-- skilltab -->
          <div id="languagetab" class="tab-pane">
            <div class="row"> 
              <div class="col-sm-12 col-lg-12 ">
                <div id="languagetable">
                  <div style="text-align:center">
                  <a href="#addlanguagemodal" data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                      <span class="btn dark-blue-btn btn-primary">Add New Language Requirement</span>
                  </a>
                  <br><br>
                </div>
                  <div id="lt"><!-- Skill management table will be loaded in this div --></div>
                  <br><br>
                </div> <!-- languagetable" -->
              </div> <!-- <div class="col-sm-12 col-lg-12 "> -->               
            </div>    <!-- row --> 
          </div> <!-- languagetab -->
          <div id="edutab" class="tab-pane">
            <div class="row"> 
              <div class="col-sm-12 col-lg-12 ">
                <div id="edutable">
                  <div style="text-align:center">
                  <a href="#addedumodal" data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                      <span class="btn dark-blue-btn btn-primary">Add New Education Requirement</span>
                  </a>
                  <br><br>
                </div>
                  <div id="et"><!-- Education management table will be loaded in this div --></div>
                  <br><br>
                </div> <!-- edutable" -->
              </div> <!-- <div class="col-sm-12 col-lg-12 "> -->               
            </div>    <!-- row --> 
          </div> <!-- edutab -->
          <div id="certtab" class="tab-pane">
            <div class="row"> 
              <div class="col-sm-12 col-lg-12 ">
                <div id="certtable">
                  <div style="text-align:center">
                  <a href="#addcertmodal" data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                      <span class="btn dark-blue-btn btn-primary">Add New Certification Requirement</span>
                  </a>
                  <br><br>
                </div>
                  <div id="ct"><!-- Certificate management table will be loaded in this div --></div>
                  <br><br>
                </div> <!-- certtable" -->
              </div> <!-- <div class="col-sm-12 col-lg-12 "> -->               
            </div>    <!-- row --> 
          </div> <!-- certtab -->
        </div> <!-- <div class="tab-content">-->   
      </div> <!--innerspace -->
    </div> <!--powerwidget -->
      </div> <!-- <div class="col-md-12 bootstrap-grid"> -->
    </div> <!-- END  row -->




        

</div>
</div>
</div>







<script>


$(function(){

  $("#st").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Skill RequirementTable now... </div>"); 
  $("#lt").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Language RequirementTable now... </div>"); 
  $("#et").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Education Requirement Table now... </div>"); 
  $("#ct").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Certification Requirement Table now... </div>"); 

   $('#job_title').editable(
    {
      source: "/getjobtitle",
      emptytext: '--',
    // placeholder: '[Optional] Enter your achievement here'
  });


$('#job_location').editable(
    {
      source: "/getcountries",
      emptytext: '--',

   });
      
      $('#job_industry  ').editable(
    {
      source: "/getind",
      emptytext: '--',

   });

      $('#job_travel').editable(
    {
      emptytext: '--',
   });




      $('#job_salarymin').editable(
    {
      emptytext: '--',
   });

      $('#job_salarymax').editable(
    {
      emptytext: '--',
   });

      $('#job_experience').editable(
    {
      emptytext: '--',
   });

      $('#job_time').editable(
    {
      source: "/getworktime",
      emptytext: '--',
   });

     $('#job_function').editable(
    {
      source: "/getfunction",
      emptytext: '--',
   });
   
  if (<%=@job.job_jdurl== ''%>  ){
    document.getElementById( 'displaycv' ).style.visibility = 'hidden';
    console.log("hidden");
  }
    else {
      document.getElementById( 'displaycv' ).style.visibility = 'visible';
      console.log("visible");
  };

  if (<%=@job.job_nationalityall%>){

      //document.getElementById( 'displaynationality' ).style.visibility = 'hidden';
      // $('#job_nationality').editable('toggleDisabled');
      $('#job_nationality').editable('option', 'disabled', true);
      document.getElementById("nationalityprcheck").disabled = true;
      document.getElementById("t1").style.color = "DDE1DD";
      document.getElementById("t2").style.color = "DDE1DD";
      document.getElementById("job_nationality").style.color = "#DDE1DD";
      $("#infobox").html("Anyone can apply for this job");
             
  } else {

      //document.getElementById( 'displaynationality' ).style.visibility = 'visible';
      // $('#job_nationality').editable('toggleDisabled');
           $('#job_nationality').editable(
            {
              source: "/getcountries",
              emptytext: '--',
            
           });
      $('#job_nationality').editable('option', 'disabled', false);
      document.getElementById("nationalityprcheck").disabled = false;
      document.getElementById("t1").style.color = "#555";
      document.getElementById("t2").style.color = "#555";
      document.getElementById("job_nationality").style.color = "#555";
      $("#infobox").html("Only citizens from the chosen country can apply. You can also allow/disallow PR from that chosen country from apply (which means only citizen can apply");
    
  }
  // Load this skill table first. Everything else can wait.
  $("#st").load("/j_table",{i: new Date().getTime(), pk: <%=@job.id%>});   //putting the current time as a parameter to overcome IE issue




      $('#skilltable').editable({
        selector: 'a.skillrank',
        showbuttons: false
      });

      $('#languagetable').editable({
        selector: 'a.job_lang_speakskill',
        showbuttons: false
      });

      $('#languagetable').editable({
        selector: 'a.job_lang_writeskill',
        showbuttons: false
      });

      $('#edutable').editable({
        selector: 'a.job_edu_pref',
        source: "/getpref",
        showbuttons: false
      });

      $('#certtable').editable({
        selector: 'a.job_cert_pref',
        source: "/getpref",
        showbuttons: false
      });

});



//Scripts not in the $(function())





// ------------ POST LOADING START Loading the respective tables when user click on the tab.--------
      $('#languagetabclick').one("click", function() {
          $("#lt").load("/j_langtable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
      });

      $('#edutabclick').one("click", function() {
          $("#et").load("/j_edutable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
      });

      $('#certtabclick').one("click", function() {
          $("#ct").load("/j_certtable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
      });
//-------------------------END OF POST LOADING ------------------------------------

      $('#saveskill-btn').click(function() {
         $('.newskill').editable('submit', {
             url: '/j_newskill',
             data: {"pk" : <%=@job.id%>},
             ajaxOptions: {
                 dataType: 'json' 
             },       
             success: function(data, config) {
             
                  if(data && data.errors){
                       //server-side validation error, response like {"errors": {"username": "username already exist"} }
                       //config.error.call(this, data.errors);
                       newAlert("#alert_placeholder-inmodal",'danger', data.errors);
                 }   else{

                      newAlert("#alert_placeholder-inmodal",'success', data.responsemsg);

                      $('.newskill').editable('setValue', null);  //clear values
                      $('#skillname').editable('option', 'disabled', true);
                      $('#skillrank').editable('option', 'disabled', true);
                      $("#st").load("/j_table",{i: new Date().getTime(), pk: <%=@job.id%>});
                 }   
             },
             error: function(errors) {
                 var msg = '';
                 if(errors && errors.responseText) { //ajax error, errors = xhr object
                     msg = errors.responseText;
                     //We do not have any response text from backend at the moment
                 } else { //validation error (client-side or server-side)
                     $.each(errors, function(k, v) {
                      if (k=="skillcatid") {k = "Skill Category"};
                      if (k=="skillid") {k = "Skill name"};
                      if (k=="skillrank") {k = "Skill rank"};     
                      msg += k+": "+v+"<br>";
                    });
                     newAlert("#alert_placeholder-inmodal",'danger', msg);
                  
                 }
              
             }
         });
      });



      $('#closeskill-btn').click(function() {
          $('.newskill').editable('setValue', null)  //clear values
              .editable('option', 'pk', null)          //clear pk
              .removeClass('editable-unsaved');        //remove bold css

      });


      $('#savelanguage-btn').click(function() {
         $('.newlang').editable('submit', {
             url: '/j_newlanguage',
             data: {"pk" : <%=@job.id%>},
             ajaxOptions: {
                 dataType: 'json' //assuming json response
             },       
             success: function(data, config) {
             
                  if(data && data.errors){
                       //server-side validation error, response like {"errors": {"username": "username already exist"} }
                       //config.error.call(this, data.errors);
                       newAlert("#alert_placeholder-inmodal2",'danger', data.errors);

                 }   else{

                      newAlert("#alert_placeholder-inmodal2",'success', 'New Language added!');

                      $('.newlang').editable('setValue', null);  //clear values
                      $('#job_lang_speakskill').editable('option', 'disabled', true);
                      $('#job_lang_writeskill').editable('option', 'disabled', true);
                      // $("#lt").load("/langtable");
                      $("#lt").load("/j_langtable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
                 }   
             },
             error: function(errors) {
                 var msg = '';
                 if(errors && errors.responseText) { //ajax error, errors = xhr object
                     msg = errors.responseText;
                     //We do not have any response text from backend at the moment
                 } else { //validation error (client-side or server-side)
                     $.each(errors, function(k, v) {
                      if (k=="job_lang") {k = "Language"};
                      if (k=="job_lang_speakskill") {k = "Spoken skill level"};
                      if (k=="job_lang_writeskill") {k = "Written skill level"};     
                      msg += k+": "+v+"<br>";
                    });
                     newAlert("#alert_placeholder-inmodal2",'danger', msg);
                  
                 }
              
             }
         });
      });

      $('#closelanguage-btn').click(function() {
          $('.newlang').editable('setValue', null)  //clear values
              .editable('option', 'pk', null)          //clear pk
              .removeClass('editable-unsaved');        //remove bold css

      });


      $('#saveedu-btn').click(function() {
         $('.newedu').editable('submit', {
             url: '/j_newedu',
             data: {"pk" : <%=@job.id%>},
             ajaxOptions: {
                 dataType: 'json' //assuming json response
             },       
             success: function(data, config) {
             
                  if(data && data.errors){
                       //server-side validation error, response like {"errors": {"username": "username already exist"} }
                       // config.error.call(this, data.errors);
                       newAlert("#alert_placeholder-inmodal3",'danger', data.errors);

                 }   else{

                      newAlert("#alert_placeholder-inmodal3",'success', 'New Education Requirement Added!');

                      $('.newedu').editable('setValue', null);  //clear values
                      $('#specialty').editable('option', 'disabled', true);
                      $('#honors').editable('option', 'disabled', true);
                      // $("#lt").load("/langtable");
                      $("#et").load("/j_edutable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
                 }   
             },
             error: function(errors) {
                 var msg = '';
                 if(errors && errors.responseText) { //ajax error, errors = xhr object
                     msg = errors.responseText;
                     //We do not have any response text from backend at the moment
                 } else { //validation error (client-side or server-side)
                     $.each(errors, function(k, v) {
                      if (k=="job_edu_title") {k = "Education title"};
                      if (k=="job_edu_specialty") {k = "Specialty"};
                      if (k=="job_edu_honors") {k = "Honors"};   
                      if (k=="job_edu_pref") {k = "Preference level"};     
                      msg += k+": "+v+"<br>";
                    });
                     newAlert("#alert_placeholder-inmodal3",'danger', msg);
                  
                 }
              
             }
         });
      });

      $('#closeedu-btn').click(function() {
          $('.newedu').editable('setValue', null)  //clear values
              .editable('option', 'pk', null)          //clear pk
              .removeClass('editable-unsaved');        //remove bold css

      });

      

      $('#savecert-btn').click(function() {
         $('.newcert').editable('submit', {
             url: '/j_newcert',
             data: {"pk" : <%=@job.id%>},
             ajaxOptions: {
                 dataType: 'json' //assuming json response
             },       
             success: function(data, config) {
             
                  if(data && data.errors){
                       //server-side validation error, response like {"errors": {"username": "username already exist"} }
                       // config.error.call(this, data.errors);
                       newAlert("#alert_placeholder-inmodal4",'danger', data.errors);

                 }   else{

                      newAlert("#alert_placeholder-inmodal4",'success', 'New Certification Requirement Added!');

                      $('.newcert').editable('setValue', null);  //clear values
                      $("#ct").load("/j_certtable",{i: new Date().getTime(), pk: <%=@job.id%>}); 
                 }   
             },
             error: function(errors) {
                 var msg = '';
                 if(errors && errors.responseText) { //ajax error, errors = xhr object
                     msg = errors.responseText;
                     //We do not have any response text from backend at the moment
                 } else { //validation error (client-side or server-side)
                     $.each(errors, function(k, v) {
                      if (k=="job_cert_title") {k = "Education title"};
                      if (k=="job_cert_pref") {k = "Preference level"};     
                      msg += k+": "+v+"<br>";
                    });
                     newAlert("#alert_placeholder-inmodal4",'danger', msg);
                  
                 }
              
             }
         });
      });

      $('#closecert-btn').click(function() {
          $('.newcert').editable('setValue', null)  //clear values
              .editable('option', 'pk', null)          //clear pk
              .removeClass('editable-unsaved');        //remove bold css

      });

// START Delete functions for Tables 
      function deledu(element,i){
        $.ajax({
                url: '/j_deleteedu',
                type: 'POST',
                data: {"pk" : i, "jobid" :<%=@job.id%>},
                success: function(response){
                   //$(element).parents('tr').remove();
              
                  //var row = $(this).closest('tr');
                  var row=$(element).parents('tr')
                  $('#edusettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Education Requirement Deleted!");
                }

              });
      }//function


      function delcert(element,i){
        $.ajax({
                url: '/j_deletecert',
                type: 'POST',
                data: {"pk" : i, "jobid" :<%=@job.id%>},
                success: function(response){
                   //$(element).parents('tr').remove();
              
                  //var row = $(this).closest('tr');
                  var row=$(element).parents('tr')
                  $('#certsettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Certification Requirement Deleted!");
                }

              });
      }//function

      function delskill(element,i){
        $.ajax({
                url: '/j_deleteskill',
                type: 'POST',
                data: {"pk" : i, "jobid" :<%=@job.id%>},
                success: function(response){
                   //$(element).parents('tr').remove();
              
                  //var row = $(this).closest('tr');
                  var row=$(element).parents('tr')
                  $('#skillsettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Skill deleted!");

                }

              });
      }//function


      function dellanguage(element,i){
        $.ajax({
                url: '/j_deletelanguage',
                type: 'POST',
                data: {"pk" : i, "jobid" :<%=@job.id%>},
                success: function(response){
                  var row=$(element).parents('tr')
                  $('#languagesettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Language deleted!");

                }

              });
      }//function

// END Delete functions for Tables 


//START Checkbox mechanism

      function nationalityprcheck(a,i){
          $.ajax({
            url: '/updatenationalitypr',
            type: 'POST',
            data: {"job_nationalitypr": a.checked, "pk" : i},
          })
        };

      function workemergencycheck(a,i){
          $.ajax({
            url: '/updateemergencyhour',
            type: 'POST',
            data: {"job_workemergency": a.checked, "pk" : i},
          })
        };

      function nationalityallcheck(a,i){
          $.ajax({
            url: '/updatenationalityall',
            type: 'POST',
            data: {"job_nationalityall": a.checked, "pk" : i},
            beforeSend : function(){
              $("#saving_intern").html("<div id='saver_i'><div id='saver_fulltime'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){  
                obj = JSON.parse(response)
                if (obj.responsemsg){
                  //document.getElementById( 'displaynationality' ).style.visibility = 'hidden';
                  // $('#job_nationality').editable('toggleDisabled');
                  $('#job_nationality').editable('option', 'disabled', true);
                  document.getElementById("nationalityprcheck").disabled = true;
                  document.getElementById("t1").style.color = "DDE1DD"; 
                  document.getElementById("t2").style.color = "DDE1DD"; 
                  document.getElementById("job_nationality").style.color = "#DDE1DD"; 
                  $("#infobox").html("Anyone can apply for this job");
                } else {
                  //document.getElementById( 'displaynationality' ).style.visibility = 'visible';
                  // $('#job_nationality').editable('toggleDisabled');
                  $('#job_nationality').editable(
                    {
                      source: "/getcountries",
                      emptytext: '--',
                    // placeholder: '[Optional] Enter your achievement here'
                   });
                  $('#job_nationality').editable('option', 'disabled', false);
                  document.getElementById("nationalityprcheck").disabled = false;
                  document.getElementById("t1").style.color = "#555"; 
                  document.getElementById("t2").style.color = "#555"; 
                  document.getElementById("job_nationality").style.color = "#555"; 
                  $("#infobox").html("Only citizens from the chosen country can apply. You can also allow/disallow PR from that chosen country from apply (which means only citizen can apply");
                         };                 
                   

               $('#saver_i').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }; // function

//END Checkbox mechanism
      


      function newAlert (loc, type, message) {
          $(loc).append($("<div class='alert alert-block alert-" + type + " fade in' data-alert><p> " + message + " </p></div>"));
          $(".alert").delay(2000).fadeOut("slow", function () { $(this).remove(); });
      };     
 


</script>
 -->