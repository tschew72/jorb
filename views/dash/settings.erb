<div class="settingsLayout">
  <h1>Career Profile</h1> 
    <section class="searchStatus">
      <h2>Job Search Status</h2>
      <span>Activate Job Search</span>
      <input type="checkbox" name="activeseeker" id="activecheck"  <%= @userprofile.activeseeker ? "checked" : "unchecked" %>>
      <label for="activecheck"></label> <span id="saving"></span>
      <div id="spr_block" style="visibility: <%= @userprofile.activeseeker ? "visible" : "hidden" %>;" > 
        <span>I am in Singapore</span>
        <input type="checkbox" name="insingaporenow" id="insgcheck" <%= @userprofile.insingaporenow ? "checked" : "unchecked" %>>
        <label for="insgcheck"></label> 
        <div style="visibility: <%= @userprofile.insingaporenow ? "visible" : "hidden" %>; display:inline" id="insg_block"> 
          <span>on these dates</span><input type="text" value="10/03/2005 - 14/04/2005 " class="datePicker" name="date-range-picker" readonly="true"><span id="saving_date"></span>
        </div>           
      </div> <!--spr_block -->
    </section> <!--searchStatus --> 

    <section class="CV">
      <h2>CV / Résumé</h2>
      <div class="cvUpload">
          <div class="inputlabel">  </div> 
          <span id="CVsection"> <a href=<%= @userprofile.cvurl %> target="_blank" > <i class="fa fa-file-text-o"><br><div>My CV</div></i> </a></span>
          <script src='/vendor/jqueryfileupload/js/vendor/jquery.ui.widget.js' type='text/javascript'></script>
          <script src='/vendor/jqueryfileupload/js/jquery.iframe-transport.js' type='text/javascript'></script>
          <script src='/vendor/jqueryfileupload/js/jquery.fileupload.js' type='text/javascript'></script>
          <script src='/vendor/jqueryfileupload/js/jquery.fileupload-process.js' type='text/javascript'></script>
          <script src='/vendor/jqueryfileupload/js/jquery.fileupload-validate.js' type='text/javascript'></script>
          <script src='/vendor/cloudinary/jquery.cloudinary.js' type='text/javascript'></script>
          <script type="text/javascript">$.cloudinary.config({cloud_name:'dashy', api_key:'219441847515364'}); </script>
          <span class="btn dark-blue-btn btn-primary fileinput-button">
            <div id="uploadprogress"><i class="glyphicon glyphicon-plus"></i> <span >Upload new CV</span></div> <input name="file" type="file" id="fileupload" class="cloudinary-fileupload" data-cloudinary-field="image_upload" ></span>
          <script type="text/javascript">
            $(function(){
              $('#fileupload').fileupload({
                  add: function (e, data) {
                      $.getJSON('/filer_cv', { userid: <%= @user.id %>}, function (result) {
                          data.formData = result; // e.g. {id: 123}
                          data.submit();
                      }).fail( function(d, textStatus, error) {
                          console.error("Error! Please contact helpdesk. Status: " + textStatus + ", error: "+error)
                      });
                  },
                  url: "https://api.cloudinary.com/v1_1/dashy/upload",
                  acceptFileTypes: /(\.|\/)(doc?x|pdf|txt)$/i, 
                  // The maximum allowed file size in bytes:
                  maxFileSize: 10000000, // 10 MB
                  // The minimum allowed file size in bytes:
                  minFileSize: 1, // No minimal file size
                  // The limit of files to be uploaded:
                  maxNumberOfFiles: 10
                })
              });

              $('.cloudinary-fileupload').bind('cloudinarydone', function(e, data) { 
                 $.ajax({
                      url: '/cvuploaded',
                      type: 'POST',
                      data: {"cvurl": data.result.url, "pk" : <%=@user.id %>},
                      success: function(response){
                        tt = "<a href=".concat(data.result.url,"><i style='font-size: 25px;' class='fa fa-file-text-o'><br><div style='font-size: 14px;left:-10px;position:relative'>My CV</div></i></a>");
                        $('#CVsection').html(tt);
                                  $("#uploadprog").html("Uploading is complete!");
                                  $('#uploadprog').fadeOut(3000, function() {
                                    $(this).remove();
                                    $("#uploadprogress").html("<i class='glyphicon glyphicon-plus'></i> <span >Upload new CV</span>");
                                   });
                      
                      }
                 }); //ajax
                 return true;
              }); //cloudinary done

              $('.cloudinary-fileupload').bind('fileuploadprogress', function(e, data) {
                $("#uploadprogress").html("<div id='uploadprog'> <i class='fa fa-spinner fa-spin'></i>Uploading in progress</div> </div>");
              });

              $('.cloudinary-fileupload').bind('fileuploadstop', function(e, data) {

              });

               $('.cloudinary-fileupload').bind('fileuploadfail', function(e, data) {
                  alert(data.files[0].error);
              });
          </script> <!-- cloudinary scripts -->
      </div> <!-- cvUpload -->
        <p>Availability (months):
          <a class="inputText" href="#" id="availability" data-name="availability" data-type="text" data-pk="<%=@userprofile.id %>" data-url="/updatetmeprofile" data-title="Enter your availability"><%= @userprofile.availability %></a>
          
        </p>
    </section> <!-- CV -->


    <section class="jobPreferences">
      <h2>Job Preferences</h2>
      <p>Current monthly salary:S$
        <a class="inputText" href="#" id="currentsalary" data-name="currentsalary" data-type="text" data-pk="<%=@userprofile.id %>" data-url="/updatetmeprofile" data-title="Enter current salary"><%= @userprofile.currentsalary %></a>
      </p>
      <p>Expected monthly salary:S$ 
        <a class="inputText" href="#" id="expectedsalary" data-name="expectedsalary" data-type="text"  data-pk="<%=@userprofile.id %>" data-url="/updatetmeprofile" data-title="Enter expected salary"><%= @userprofile.expectedsalary %></a>
      </p>   
      <p>Levels:
        <a class="inputText" href="#" id="joblevel" data-type="select2" data-value="<%= @pref_level%>"  data-pk="<%=@user.id %>" data-url="/updatelevelpref" data-title="Enter preferred job level"></a>
      </p>
      <p>Functions:
        <a class="inputText" href="#" id="jobfunction" data-type="select2" data-value="<%= @pref_func %>"  data-pk="<%=@user.id %>" data-url="/updatefuncpref" data-title="Enter preferred job functions"></a>
      </p>
      <p>Industries:
        <a class="inputText" href="#" id="industries" data-type="select2" data-value="<%= @pref_ind %>"  data-pk="<%=@user.id %>" data-url="/updateindpref" data-title="Enter preferred industries"></a>
      </p>
      <p>Locations:         
        <a class="inputText" href="#" id="locations" data-type="select2" data-value="<%= @pref_loc %>"  data-pk="<%=@user.id %>" data-url="/updatelocpref" data-title="Enter preferred locations"></a>
      </p>
      <p>Travel Frequency:
        <span>0%</span><input name= "freq" id="f0" type="radio" onclick="freqcheck(this)"  value="25"> 
        <span>25%</span><input name= "freq" id="f1" type="radio" onclick="freqcheck(this)"  value="25"> 
        <span>50%</span><input name= "freq" id="f2" type="radio" onclick="freqcheck(this)"  value="50">
        <span>75%</span><input name= "freq" id="f3" type="radio" onclick="freqcheck(this)"  value="75"> 
        <span>100%</span><input name= "freq" id="f4" type="radio" onclick="freqcheck(this)"  value="100"> 
        <span id="saving_radio"></span>
      </p>
      <p>
        Job Types:
        <span>Full Time</span><input type="checkbox" name="fulltime" id="fulltimecheck"   <%= @userprofile.fulltime.to_s == "true" ? "checked" : "unchecked" %>><label for="fulltimecheck"></label>
        <span>Part Time</span><input type="checkbox" name="parttime" id="parttimecheck"   <%= @userprofile.parttime.to_s == "true" ? "checked" : "unchecked" %>><label for="parttimecheck"></label>
        <span>Shift Work</span><input type="checkbox" name="shiftwork" id="shiftworkcheck" <%= @userprofile.shiftwork.to_s == "true" ? "checked" : "unchecked" %>><label for="shiftworkcheck"></label>
        <span>Internship</span><input type="checkbox" name="skr_intern" id="interncheck"   <%= @userprofile.skr_intern.to_s == "true" ? "checked" : "unchecked" %>><label for="interncheck"></label>
        <span>AfterOfficeHour</span><input type="checkbox" name="outofhours" id="outofhourscheck" <%= @userprofile.outofhours.to_s == "true" ? "checked" : "unchecked" %>><label for="outofhourscheck"></label>
        <span>Freelance/Contract</span><input type="checkbox" name="skr_contractor" id="contractorcheck" <%= @userprofile.skr_contractor.to_s == "true" ? "checked" : "unchecked" %>><label for="contractorcheck"></label>                 
        <span id="saving_out"></span>
      </p>
    </section> <!--jobPreferences -->

    <section class="Achievements">
      <h2>Achievements</h2>
      <p> List all your major achievements below:
        <br>
        <div>
        <a class="ec inputText" href="javascript:void(0)" data-type="wysihtml5" data-pk="<%=@myachievements.skr_achieve_id %>" data-url="/updateachievement" data-title="Enter achievements"><%= @myachievements.achievement != '' ? @myachievements.achievement : "[Optional] Enter your achievement here"%> </a>
        </div>
      </p>
    </section> <!-- achievements -->
  
    <section class="Experiences">
      <h2>Experience </h2>  
        <a href="#addexperiencemodal" data-pk=<%= @user.id %>  data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
            <span class="btn dark-blue-btn btn-primary">Add New Job Experience</span>
        </a>
        <div id="jt"> 
          <!-- Job Experience table will be loaded in this div -->
        </div>
    </section>  <!-- experiences -->

    <section class="Competencies">
      <h2>Competencies</h2>
      <ul class="nav nav-tabs"> 
        <li class="active"><a id="skilltabclick" data-toggle="tab" href="#skilltab" >Skills</a></li>   
        <li><a id="languagetabclick" data-toggle="tab" href="#languagetab">Languages</a></li>   
        <li><a id="edutabclick" data-toggle="tab" href="#edutab">Education</a></li>    
        <li><a id="certtabclick" data-toggle="tab" href="#certtab">Certificates</a></li>                  
      </ul>

      <div class="tab-content">
        <div id="skilltab" class="tab-pane active">
          <div id="skilltable">
            <a href="#addskillmodal" data-pk=<%= @user.id %> data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                <span class="btn dark-blue-btn btn-primary">Add New Skill</span>
            </a>
            <div id="st"> <!-- Skill management table will be loaded in this div --></div>
          </div> <!-- skilltable" -->
        </div> <!-- skilltab -->

        <div id="languagetab" class="tab-pane">
          <div id="languagetable">
            <a href="#addlanguagemodal" data-pk=<%= @user.id %> data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                <span class="btn dark-blue-btn btn-primary">Add New Language</span>
            </a>
            <div id="lt"><!-- Skill management table will be loaded in this div --></div>
          </div> <!-- languagetable" -->
        </div> <!-- languagetab -->

        <div id="edutab" class="tab-pane">
          <div id="edutable">
            <a href="#addedumodal" data-pk=<%= @user.id %> data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                <span class="btn dark-blue-btn btn-primary">Add New Education</span>
            </a>
            <div id="et"><!-- Education management table will be loaded in this div --></div>
          </div> <!-- edutable" -->
        </div> <!-- edutab -->

        <div id="certtab" class="tab-pane">
          <div id="certtable">
            <a href="#addcertmodal" data-pk=<%= @user.id %> data-toggle="modal" data-keyboard="false" data-backdrop="static" role="button">
                <span class="btn dark-blue-btn btn-primary">Add New Certification</span>
            </a>
            <div id="ct"><!-- Certificate management table will be loaded in this div --></div>
          </div> <!-- certtable" -->
        </div>

      </div> <!-- <div class="tab-content">-->   
    </section> <!-- skills -->

  </div> <!-- layout -->


                   
  <script>

  $(document).ready(function(){

  $("#st").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Skill RequirementTable now... </div>"); 
  $("#lt").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Language RequirementTable now... </div>"); 
  $("#et").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Education Requirement Table now... </div>"); 
  $("#ct").html("<div id='loader'><i class='fa fa-spinner fa-spin'></i>Loading Certification Requirement Table now... </div>"); 

  $("#jt").load("/experiencetable",{i: new Date().getTime(), pk: <%=@user.id%>}); 
  document.getElementById('f1').scrollIntoView()
  $("#st").load("/table",{i: new Date().getTime(), pk: <%=@user.id%>}); 

                //non singaporean and non-PR and active in seeking for job, show it!
              if (<%= @mynations %> != 157 && <%= @mynationtypes %> !=2 && <%= @userprofile.activeseeker %>){
                 document.getElementById( 'spr_block' ).style.visibility = 'visible';
                 if (<%= @userprofile.insingaporenow%> ){
                  document.getElementById( 'insg_block' ).style.visibility = 'visible';
                 }
              };

              if (<%= @mynations %> == 157 || <%= @mynationtypes %> ==2)  {
                document.getElementById( 'spr_block' ).style.visibility = 'hidden';
                document.getElementById( 'insg_block' ).style.visibility = 'hidden';
              } ;

              if (<%= @userprofile.travelfreq %> ==0){
                document.getElementById("f0").checked = true;
               }
              if (<%= @userprofile.travelfreq %> ==25){
                document.getElementById("f1").checked = true;
               }
              if (<%= @userprofile.travelfreq %> ==50){
                document.getElementById("f2").checked = true;
               }
              if (<%= @userprofile.travelfreq %> ==75){
                document.getElementById("f3").checked = true;
               }
              if (<%= @userprofile.travelfreq %> ==100){
                document.getElementById("f4").checked = true;
               }

              // $("#st").load("/table",{i: new Date().getTime()});   //putting the current time as a parameter to overcome IE issue
              //$("#lt").load("/langtable",{i: new Date().getTime()}); 

       $('input[name="date-range-picker"]').daterangepicker({
        timePicker: false,
        showDropdowns: true,
        format: 'DD/MM/YYYY',
        }, function(start, end, label) {
          console.log(moment(start.format('YYYY-MM-DDTHH:mm:ss') + 'Z').utc().toISOString());
          from = moment(start.format('YYYY-MM-DDTHH:mm:ss') + 'Z').utc().toISOString();
          end =moment(end.format('YYYY-MM-DDTHH:mm:ss') + 'Z').utc().toISOString();
           $.ajax({
              url: '/update_inSG_Date',
              type: 'POST',
              data: {"insg_start": from, "insg_end": end, "pk" : <%=@userprofile.id %>},
              beforeSend : function(){
                $("#saving_date").html("<span id='saver'><i class='fa fa-spinner fa-spin'></i></span>");
              }, 
              success: function(response){
                          // newAlert("#alert_placeholder-tab", 'success', "Dates recorded");
                           $('#saver').fadeOut(1000, function() {
                            $(this).remove();
                           });
                        }
            });
        });

      $('#skr_careergoal').editable({
        tpl: "<input type='text' style='width: 700px';height:500px>",
        validate: function(value){
          if (!value) return 'This field is required';
          if(value.length >5000 ) {
            return 'You can only enter a maximum of 500 characters';
          }
        } //function 

      });

      $('#skilltable').editable({
        selector: 'a.skillrank',
        showbuttons: false
      });

      $('.Achievements').editable({
        selector: 'a.ec',
        tpl: "<input type='text' style='width: 700px';height:500px>",
        validate: function(value){
          if (!value) return 'This field is required';
          if(value.length >5000 ) {
            return 'You can only enter a maximum of 500 characters';
          }
        }, //function 
        emptytext: '[Optional] Enter your achievement here',
        placeholder: '[Optional] Enter your achievement here'
      });
      // $('#skilltable').editable({
      //   selector: 'a.skills'
      // });

      $('#languagetable').editable({
        selector: 'a.skr_lang_speakskill',
        showbuttons: false
      });

      $('#languagetable').editable({
        selector: 'a.skr_lang_writeskill',
        showbuttons: false
      });


      $('#expectedsalary').editable();
      $('#currentsalary').editable();
      $('#availability').editable();
      $('#skr_emp_currentjob').editable({disabled: true }); 

      $('#expectedsalary').editable('option', 'validate', function(v) {
          if(!v) return 'This is a required field!';
      });

      $('#currentsalary').editable('option', 'validate', function(v) {
          if (!isInt(v)){
            return "Invalid entry. Please re-enter";             
          }
      });

      $('#expectedsalary').editable('option', 'validate', function(v) {
          if (!isInt(v)){
            return "Invalid entry. Please re-enter";             
          }
      });


 

      $('#industries').editable({
     
           source: function() {
                return (<%= @industries%>)
              },
        select2: {
           multiple: true,
           dropdownAutoWidth : true,
           placeholder: 'Select Industries', width: '500px'
        },
        allowClear: true,
        minimumInputLength: 3,
        mode: 'popup',
        showbuttons: 'bottom',
        placement: 'bottom',
        emptytext: 'Select your preferred industries'
      });

      $('#locations').editable({
     
           source: function() {
                return (<%= @locations %>)
              },
        select2: {
           multiple: true,
           dropdownAutoWidth : true,
           placeholder: 'Select locations', width: '500px'
        },
        allowClear: true,
        minimumInputLength: 3,
        mode: 'popup',
        showbuttons: 'bottom',
        placement: 'bottom',
        emptytext: 'Select your preferred Job locations'
      });

      $('#joblevel').editable({
     
           source: function() {
                return (<%= @levels%>)
              },
        select2: {
           multiple: true,
           dropdownAutoWidth : true,
           placeholder: 'Select Job Levels', width: '500px'
        },
        allowClear: true,
        minimumInputLength: 3,
        mode: 'popup',
        showbuttons: 'bottom',
        placement: 'bottom',
        emptytext: 'Select your preferred Job levels'
      });

      $('#jobfunction').editable({
     
           source: function() {
                return (<%= @functions%>)
              },
        select2: {
           multiple: true,
           dropdownAutoWidth : true,
           placeholder: 'Select Job Functions', width: '500px'
        },
        allowClear: true,
        minimumInputLength: 3,
        mode: 'popup',
        showbuttons: 'bottom',
        placement: 'bottom',
        emptytext: 'Select your preferred Job functions'
      });

        $('#skillsettingtable').dataTable( {  
            "scrollY": 200,
            "ScrollX": true,
            "iDisplayLength": 10,
            "order": [[ 0, "desc" ]],
            "scrollCollapse": true,
            "jQueryUI": true,
            "aoColumns": [       
                null, null, null,
                { "bSortable": false }
              ]
        } );

        $('#languagesettingtable').dataTable( {
            "scrollY": 200,
            "ScrollX": true,
            "iDisplayLength": 10,
            "order": [[ 0, "desc" ]],
            "scrollCollapse": true,
            "jQueryUI": true,
            "aoColumns": [       
                null, null, null,
                { "bSortable": false }
              ]
        } );

      //  $('.datePicker').datepicker({autoclose:true}).next().on(ace.click_event, function(){
      //     $(this).prev().focus();
      // });

 

      $('[data-rel=tooltip]').tooltip();
      $('[data-rel=popover]').popover({html:true});



     


   }); //document ready


  </script>





<script>
// ------------ POST LOADING START Loading the respective tables when user click on the tab.--------
      // $('#skilltabclick').one("click", function() {
      //     $("#st").load("/table",{i: new Date().getTime(), pk: <%=@userprofile.id%>}); 
      // });
      $('#languagetabclick').one("click", function() {
          $("#lt").load("/langtable",{i: new Date().getTime(), pk: <%=@user.id%>}); 
      });

      $('#edutabclick').one("click", function() {
          $("#et").load("/edutable",{i: new Date().getTime(), pk: <%=@user.id%>}); 
      });

      $('#certtabclick').one("click", function() {
          $("#ct").load("/certtable",{i: new Date().getTime(), pk: <%=@user.id%>}); 
      });
//-------------------------END OF POST LOADING ------------------------------------


    $("#activecheck").on('change', function(){
      $.ajax({
        url: '/updateactive',
        type: 'POST',
        data: {"activeseeker": this.checked, "pk" : <%=@user.id %>},
        beforeSend : function(){
          $("#saving").html("<span id='saver'><i class='fa fa-spinner fa-spin'></i></span>");
        }, 
        success: function(response){
          var data = JSON.parse(response);

          if (data.active){
             if (data.singaporepr != 2)
              {document.getElementById( 'spr_block' ).style.visibility = 'visible';}
             if (data.singaporepr != 2 && data.insingaporenow){
                document.getElementById( 'insg_block' ).style.visibility = 'visible';}
           // newAlert("#alert_placeholder-tab", 'success', "Thanks for informing us that you are actively seeker for job");                 
          } else{
             document.getElementById( 'spr_block' ).style.visibility = 'hidden';
             document.getElementById( 'insg_block' ).style.visibility = 'hidden';
             // newAlert("#alert_placeholder-tab", 'success', "Thanks for informing us that you are not actively looking for job now.");
            
          }; //else
          // $("#saving").html("<div id='saver'>Saved...</div>");
          $('#saver').fadeOut(1000, function() {
          $(this).remove();
         });
        } //success function
      }); //ajax
  }); //activecheck function

  $("#insgcheck").on('change', function(){
      $.ajax({
        url: '/updateinsgnow',
        type: 'POST',
        data: {"insingaporenow": this.checked, "pk" : <%=@user.id %>},
        beforeSend : function(){
          $("#saving1").html("<div id='saver'><i class='fa fa-spinner fa-spin'></i></div>");
        },
        success: function(response){
          var data = JSON.parse(response);
          if (data.insingaporenow){
             document.getElementById( 'insg_block' ).style.visibility = 'visible';
             // newAlert("#alert_placeholder-tab", 'success', "Welcome to Singapore!");            
          } else{
             document.getElementById( 'insg_block' ).style.visibility = 'hidden';
             // newAlert("#alert_placeholder-tab", 'success', "Look forward to see you in Singapore soon!");
                          
          }; //else
              // $("#saving1").html("<div id='saver'>Saved...</div>");
              $('#saver').fadeOut(1000, function() {
               $(this).remove();
             });
        } //success function
     
      });
  });


        $("#parttimecheck").on('change', function(){
          $.ajax({
            url: '/updateparttime',
            type: 'POST',
            data: {"parttime": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_parttime").html("<div id='saver_parttime'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              var data = JSON.parse(response);
              if (data.parttime){
                    newAlert("#alert_placeholder-tab", 'success', "You will be matched to any part time jobs");     
              } else {
                    newAlert("#alert_placeholder-tab", 'success', "You will not be matched to part time jobs");  
              }                        
               $('#saver_parttime').fadeOut(1000, function() {
               $(this).remove();
             }); 
            } //success function
          }); //ajax
      }); //parttime function


      $("#fulltimecheck").on('change', function(){
          $.ajax({
            url: '/updatefulltime',
            type: 'POST',
            data: {"fulltime": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_fulltime").html("<div id='saver_fulltime'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              var data = JSON.parse(response);
              if (data.fulltime){
                   newAlert("#alert_placeholder-tab", 'success', "You will be matched to full time jobs");  
              } else {

                    newAlert("#alert_placeholder-tab", 'success', "You will not be matched to full time jobs");    
              }                               
               $('#saver_fulltime').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }); //fulltime function

      $("#shiftworkcheck").on('change', function(){
          $.ajax({
            url: '/updateshiftwork',
            type: 'POST',
            data: {"shiftwork": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_shift").html("<div id='saver_shift'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              var data = JSON.parse(response);
              if (data.shiftwork){
                   newAlert("#alert_placeholder-tab", 'success', "You will be matched to jobs requiring shift work");                                    
              } else {
                   newAlert("#alert_placeholder-tab", 'success', "You will not be matched to jobs requiring shift work");  
              }
               $('#saver_shift').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }); //shiftwork function

      $("#outofhourscheck").on('change', function(){
          $.ajax({
            url: '/updateoutofhours',
            type: 'POST',
            data: {"outofhours": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_out").html("<span id='saver_out'><i class='fa fa-spinner fa-spin'></i></span>");
            },
            success: function(response){
              var data = JSON.parse(response);
              if (data.outofhours){
                   newAlert("#alert_placeholder-tab", 'success', "You will be matched to jobs requiring you to work outside office hour");
               } else {
                   newAlert("#alert_placeholder-tab", 'success', "You will not be matched to jobs requiring you to work outside office hour");  
               }                        
                $('#saver_out').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }); // function


      $("#interncheck").on('change', function(){
          $.ajax({
            url: '/updateintern',
            type: 'POST',
            data: {"skr_intern": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_intern").html("<div id='saver_i'><div id='saver_fulltime'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              var data = JSON.parse(response);                           
               $('#saver_i').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }); // function

      $("#contractorcheck").on('change', function(){
          $.ajax({
            url: '/updatecontractor',
            type: 'POST',
            data: {"skr_contractor": this.checked, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_contractor").html("<div id='saver_c'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              var data = JSON.parse(response);                           
               $('#saver_c').fadeOut(1000, function() {
               $(this).remove();
             });
            } //success function
          }); //ajax
      }); // function


      function freqcheck(myRadio) {
          $.ajax({
            url: '/updatetravelfreq',
            type: 'POST',
            data: {"travelfreq": myRadio.value, "pk" : <%=@user.id %>},
            beforeSend : function(){
              $("#saving_radio").html("<div id='saver_r'><i class='fa fa-spinner fa-spin'></i></div>");
            },
            success: function(response){
              // var data = JSON.parse(response);                           
               $('#saver_r').fadeOut(1000, function() {
                  $(this).remove();
               });
            } //success function
          }); //ajax
      }; // function



      // $("#id-date-picker-1").on('change', function(){
      //     $.ajax({
      //       url: '/updatedob',
      //       type: 'POST',
      //       data: {"dob": this.value, "pk" : <%=@userprofile.id %>}
         
      //     });
      
      // });

     //automatically show next editable 1
      // $('.newskill').on('save.newskill', function(){
      //     var that = this;
      //     setTimeout(function() {
      //         $(that).closest('tr').next().find('.newskill').editable('show');
      //     }, 200);
      // });  

      // $('.newlang').on('save.newlang', function(){
      //     var that = this;
      //     setTimeout(function() {
      //         $(that).closest('tr').next().find('.newlang').editable('show');
      //     }, 200);
      // });  


      function isInt(value) {
        return !isNaN(value) &&
               parseInt(Number(value)) == value &&
               !isNaN(parseInt(value, 10));
      }

      function delskill(element,i){
        $.ajax({
                url: '/deleteskill',
                type: 'POST',
                data: {"pk" : i},
                success: function(response){
                   //$(element).parents('tr').remove();
               
                  //var row = $(this).closest('tr');
                  var row=$(element).parents('tr')
                  $('#skillsettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Skill deleted!");

                }

              });
      }//function

      function delexp(element,i){
        $.ajax({
                url: '/deleteexp',
                type: 'POST',
                data: {"pk" : i},  //jobID
                success: function(response){
                  var row=$(element).parents('tr')
                  $('#experiencesettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Job Experience deleted!");

                }

              });
      }//function


      function dellanguage(element,i){
        $.ajax({
                url: '/deletelanguage',
                type: 'POST',
                data: {"pk" : i, "userid": <%= @user.id %>},
                success: function(response){
                  var row=$(element).parents('tr')
                  $('#languagesettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Language deleted!");

                }

              });
      }//function

      function deledu(element,i){
        $.ajax({
                url: '/deleteedu',
                type: 'POST',
                data: {"pk" : i, "userid": <%= @user.id %>},
                success: function(response){
                  var row=$(element).parents('tr')
                  $('#edusettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Education deleted!");

                }

              });
      }//function

      function delcert(element,i){
        $.ajax({
                url: '/deletecert',
                type: 'POST',
                data: {"pk" : i, "userid": <%= @user.id %>},
                success: function(response){
                  var row=$(element).parents('tr')
                  $('#certsettingtable').dataTable().fnDeleteRow(row[0]);
                  newAlert("#alert_placeholder-tab", 'success', "Certification deleted!");

                }

              });
      }//function
      function newAlert (loc, type, message) {
          $(loc).append($("<div class='alert alert-block alert-" + type + " fade in' data-alert><p> " + message + " </p></div>"));
          $(".alert").delay(2000).fadeOut("slow", function () { $(this).remove(); });
      }     
 

       $('#addexperiencemodal').on('hide.bs.modal', function(e) {   
          $("#jt").load("/experiencetable",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });
       $('#editexperiencemodal').on('hide.bs.modal', function(e) {   
          $("#jt").load("/experiencetable",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });
       $('#addskillmodal').on('hide.bs.modal', function(e) {   
          $("#st").load("/table",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });
       $('#addedumodal').on('hide.bs.modal', function(e) {   
          $("#et").load("/edutable",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });
       $('#addcertmodal').on('hide.bs.modal', function(e) {   
          $("#ct").load("/certtable",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });
       $('#addlanguagemodal').on('hide.bs.modal', function(e) {   
          $("#lt").load("/langtable",{i: new Date().getTime(), pk: <%= @user.id %>}); 
      });





</script>